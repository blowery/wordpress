<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
  <title>Dojo Playground: Loading Throbber</title>

  <script type="text/javascript" djConfig="isDebug: true" src="dojo/dojo.js"></script>
  <script type="text/javascript">
    dojo.require("dojo.fx");

    dojo.addOnLoad(function(){
      dojo.connect(dojo.byId("goBtn"), "click", findIt);
    });

    function findIt(){
      var term = dojo.trim(dojo.byId("term").value);

      function makeHi() {
        var node = dojo.query(".loadable")[0];
        var hilight = dojo.animateProperty({ node: node, 
                                             properties: { borderColor: { start: "#ddd", end: "#999"} }, 
                                             duration: 750 });
        return hilight;
      }

      function makeLow() {
     
        var lowlight = dojo.animateProperty({ node: dojo.query(".loadable")[0],
                                              properties: { borderColor: { end: "#ddd", start: "#999" }},
                                              duration: 750 } );
        return lowlight;
      }
      var hi = makeHi();
      var lo = makeLow();
      dojo.connect(hi, "onEnd", dojo.hitch(lo, "play", 0, true));
      dojo.connect(lo, "onEnd", dojo.hitch(hi, "play", 0, true));
      hi.play();
      if(dojo.style("response", "display") == "block") {
        dojo.fx.wipeOut( { node: "response" }).play();
      }
      setTimeout(function(){
        hi.stop();
        lo.stop();
        dojo.style("response", "height", "0px");
        dojo.byId("response").innerHTML = "Nothing found for " + term;
        dojo.fx.wipeIn({ node: "response" }).play();
      }, 5000);
      
    }
  </script>
  <style type="text/css">
    .loadable {
      border: 1px solid #ddd;
      border-color: #ddd;
      background: #eee;
      border-radius: 12px;
      -moz-border-radius: 12px;
      margin: 0 auto;
      padding: 2em;
      width: 300px;
    }
  </style>
</head>
<body>

<div class="loadable">
  <p>This is a widget that loads something</p>
  <form action="">
    <div>
      <label for="term">search for:</label>
      <input type="text" id="term" />
    </div>
    <div>
      <button id="goBtn" type="button">search</button>
    </div>
    <div id="response"></div>
  </form>
</div>

</body>
</html>
